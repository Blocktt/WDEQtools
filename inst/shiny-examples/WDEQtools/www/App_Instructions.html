


<div id="ibi-calculator-instructions" class="section level1">
<h1>IBI Calculator Instructions</h1>
<p>WDEQtools was developed to calculate diatom metrics and Indices of Biotic Integrity (IBI) for perennial, wadeable streams in Wyoming. Detailed documentation of IBI development can be downloaded <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Reports">here</a>. Users can run any data through the IBI calculator and get a result. However, if samples do not meet the criteria listed on the Background page, results should be interpreted with caution.</p>
<p>The Instructions are divided into three sections: 1) preparing the input file; 2) app operation; and 3) frequently asked questions (FAQ). Links to an example input file and a document containing more detailed information on preparing the input file are also provided.</p>
<p>This app was developed by Ben Block from Tetra Tech. (<a href="mailto:Ben.Block@tetratech.com" class="email">Ben.Block@tetratech.com</a>), with underlying R code written by Ben Block, Diane Allen (<a href="mailto:Diane.Allen@tetratech.com" class="email">Diane.Allen@tetratech.com</a>), and Erik Leppo (<a href="mailto:Erik.Leppo@tetratech.com" class="email">Erik.Leppo@tetratech.com</a>). Please contact Ben Block should any issues or questions arise.</p>
<div id="foreword" class="section level3">
<h3>Foreword</h3>
<p>Tetra Tech developed the WDEQtools shiny app for the Wyoming Department of Environmental Management (WDEQ). It allows WDEQ and their partners to calculate IBI scores for diatom samples. The diatom IBIs improve WDEQ’s diagnostic ability to identify degradation in biological integrity and water quality. The app is streamlined and easy to operate, and only requires an input dataset to function. Shiny apps are interactive web applications that serve as graphical user interfaces. They are linked to R, which is an open source programming language and software environment for statistical computing.</p>
</div>
<div id="preparing-the-input-file" class="section level3">
<h3>Preparing the input file</h3>
<p>WDEQtools requires input files to be in a tabular format, saved as either comma-separated values (CSV) (most commonly used) or tab-separated (.txt or .tsv) files. Table 1 contains a list of required fields. Column names must be capitalized and match the spelling and symbology exactly as shown (some column headings have underscores).</p>
<p>Click here to view an <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Example_Files">EXAMPLE INPUT FILE</a>.</p>
<p>If the user is unsure how to download a data file from GitHub, <a href="https://www.youtube.com/watch?v=GIJdfuAoqFI">watch this short video</a> or contact Ben Block (<a href="mailto:ben.block@tetratech.com" class="email">ben.block@tetratech.com</a>).</p>
<p>The input file is now ready to be run through the IBI calculator!</p>
<div id="table-1.-list-of-required-fields.-column-names-must-be-capitalized-and-match-the-spelling-and-symbology-exactly-as-shown." class="section level4">
<h4>Table 1. List of required fields. Column names must be capitalized and match the spelling and symbology exactly as shown.</h4>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;">
Column Name
</th>
<th style="text-align:left;">
Data Type
</th>
<th style="text-align:left;">
Domain (allowable entries)
</th>
<th style="text-align:left;">
Null Allowed
</th>
<th style="text-align:left;">
Comment
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
INDEX_NAME
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
WY_DiatomIBI_2022
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Only one allowable entry (WY_DiatomIBI_2022)
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEX_REGION
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
Statewide
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Only one allowable entry (Statewide)
</td>
</tr>
<tr>
<td style="text-align:left;">
STATIONID
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Unique site identifier
</td>
</tr>
<tr>
<td style="text-align:left;">
SAMPLEID
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Unique sample identifier (typically comprised of the site name, sample date, and replicate number).
</td>
</tr>
<tr>
<td style="text-align:left;">
COLLDATE
</td>
<td style="text-align:left;">
date
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Date on which the sample was collected.
</td>
</tr>
<tr>
<td style="text-align:left;">
N_TAXA
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
non-negative real number
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Number of individuals.
</td>
</tr>
<tr>
<td style="text-align:left;">
TAXAID
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Taxonomic identification of organisms in each sample.
</td>
</tr>
<tr>
<td style="text-align:left;">
EXCLUDE
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
TRUE, FALSE
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Redundant (non-distinct) taxa should marked “TRUE”.
</td>
</tr>
<tr>
<td style="text-align:left;">
NONTARGET
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
TRUE, FALSE
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Non-target taxa should be marked “TRUE”.
</td>
</tr>
<tr>
<td style="text-align:left;">
ORDER
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Taxonomic order of taxon
</td>
</tr>
<tr>
<td style="text-align:left;">
FAMILY
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Taxonomic family of taxon
</td>
</tr>
<tr>
<td style="text-align:left;">
H_WDEQ
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
Numeric value 1, 2, 3, or 4
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
WDEQ Diatom trait - Tolerance to salinity is represented by the categories of fresh to brackish waters (Van Dam et al. 1994) as interpreted by WDEQ. See the <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Reports">report appendix</a> for metric descriptions.
</td>
</tr>
<tr>
<td style="text-align:left;">
O_WDEQ
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
Numeric value 1, 2, 3, 4, or 5
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
WDEQ Diatom trait - Classification of “oxygen requirements” as summarized in Van Dam et al. (1994) and interpreted by WDEQ. See the <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Reports">report appendix</a> for metric descriptions.
</td>
</tr>
<tr>
<td style="text-align:left;">
T_WDEQ
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
Numeric value 1, 2, 3, 4, 5, 6, or 7
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
WDEQ Diatom trait - The trophic categories of Van Dam et al. (1994) as interpreted by WDEQ. See the <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Reports">report appendix</a> for metric descriptions.
</td>
</tr>
<tr>
<td style="text-align:left;">
DIATAS_TN
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
Numeric value 1 or 2
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
USGS Diatom trait -Nitrogen tolerant diatoms 1, Nitrogen sensitive diatoms, 2. See the <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Reports">report appendix</a> for metric descriptions.
</td>
</tr>
<tr>
<td style="text-align:left;">
BC_USGS
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
BC_1, BC_2, BC_3, BC_4, BC_5 (can select multiple)
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
USGS Diatom trait - The Biological Condition rating. See the <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Reports">report appendix</a> for metric descriptions.
</td>
</tr>
<tr>
<td style="text-align:left;">
SALINITY_USGS_NUM
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
Numeric value 1, 2, 3, or 4
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Numeric values that corresponding to USGS traits: SALINITY_1, SALINITY_2, SALINITY_3, SALINITY_4. USGS Diatom trait - Tolerance to salinity is represented by the categories of fresh to brackish waters (Van Dam et al. 1994). See the <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Reports">report appendix</a> for metric descriptions.
</td>
</tr>
<tr>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
real number, in decimal degrees
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
NAD83 datum
</td>
</tr>
<tr>
<td style="text-align:left;">
LONG
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
real number, in decimal degrees
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
NAD83 datum. Longitude values in North America (west of the prime meridian) should be negative .
</td>
</tr>
<tr>
<td style="text-align:left;">
Elevation
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Position above sea level in feet
</td>
</tr>
<tr>
<td style="text-align:left;">
BFIWs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Baseflow Index (BFI) is the ratio of baseflow to total flow, expressed as a percentage, within watershed.
</td>
</tr>
<tr>
<td style="text-align:left;">
SWs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Mean % of lithological sulfur (S) content in surface or near surface geology within watershed
</td>
</tr>
<tr>
<td style="text-align:left;">
KffactWs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Mean soil erodibility (Kf) factor (unitless) of soils within watershed. The Kf factor is used in the Universal Soil Loss Equation (USLE) and represents a relative index of susceptibility of bare, cultivated soil to particle detachment and transport by rainfall.
</td>
</tr>
<tr>
<td style="text-align:left;">
PrecipWs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
PRISM climate data - 30-year normal mean precipitation (mm): Annual period: 1981-2010 within the watershed
</td>
</tr>
<tr>
<td style="text-align:left;">
TmaxWs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
PRISM climate data - 30-year normal maximum temperature (°C): Annual period: 1981-2010 within the watershed
</td>
</tr>
<tr>
<td style="text-align:left;">
TmeanWs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
PRISM climate data - 30-year normal mean temperature (°C): Annual period: 1981-2010 within the watershed
</td>
</tr>
<tr>
<td style="text-align:left;">
RckDepWs
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Mean depth (cm) to bedrock of soils (STATSGO) within watershed
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="instructions" class="section level3">
<h3>Instructions</h3>
<p>Once the ‘Calculator’ tab is opened, the user will see the IBI calculator interface. The user should follow the onscreen instructions as follows:</p>
<ol style="list-style-type: decimal">
<li>Load file
<ul>
<li><strong>Default settings work well</strong>. If the user is unsure of how to format the data, simply store as a .csv and use the default load settings.</li>
<li>An example input file can be downloaded from Github <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Example_Files">EXAMPLE LINK</a></li>
<li>Choose Separator. The separator indicates how the data is stored. Comma indicates the input file is a comma-separated file (.csv). Tab indicates the input file is a tab-separated file (.txt or .tsv). Finally, Semicolon indicates the input file is a semicolon-separated file which is uncommon in the United States but common in western European countries. Be certain that the designated separator is not used in any of the text fields (e.g., for multiple BC_USGS values, separate with a semicolon).</li>
<li>Choose Quote. The quote indicates how the data is stored. Double quote is the most common.</li>
<li>Choose file to upload. Hit the browse button and search for the input file.</li>
<li>Once uploaded, make sure data look correct in the viewer. If the incorrect Separator or Quote is chosen, the user may receive an error or the data may look incorrect in the viewer.</li>
</ul></li>
<li>Calculate IBI
<ul>
<li>Hit the ‘Calculate Metric Values and Scores’ button.</li>
<li>A progress bar will appear in the bottom, right corner of the screen. Results cannot be downloaded (step 3) until the progress bar is completed and disappears.</li>
</ul></li>
<li>Download results
<ul>
<li>Select the button to download a zip file with inputs and results.</li>
<li>Check ‘results_log.txt’ for any warnings or messages. Note, some warnings are automatically generated by R. Feel free to reach out to Ben Block (<a href="mailto:Ben.Block@tetratech.com" class="email">Ben.Block@tetratech.com</a>) for any questions related to warnings.</li>
</ul></li>
</ol>
</div>
<div id="frequently-asked-questions-and-troubleshooting" class="section level3">
<h3>Frequently asked questions and troubleshooting</h3>
<ol style="list-style-type: decimal">
<li>Why am I getting an error saying that I am missing columns even when I am not?
<ul>
<li>You may have incorrectly spelled a given column. Try writing the column in all capital letters. Also, some columns (e.g., INDEX_REGION) require an underscore to separate the two words.</li>
</ul></li>
<li>Why does my data look strange in the data viewer?
<ul>
<li>You likely have the incorrect Separator or Quote selected. Otherwise, there may be commas in text fields when the comma separator is selected.</li>
</ul></li>
<li>The IBI calculation is taking forever to calculate, has the app frozen?
<ul>
<li>Even though R works remarkably fast, a large dataset will cause the app to slow down. The estimate is approximately 30 seconds for small datasets; however, this could extend to a few minutes for large datasets.</li>
</ul></li>
</ol>
</div>
</div>
<div id="metric-adjustment-factors-instructions" class="section level1">
<h1>Metric Adjustment Factors Instructions</h1>
<div id="foreword-1" class="section level3">
<h3>Foreword</h3>
<p>This tab allows the user to upload station information and assigns natural StreamCat factors. Some metrics are adjusted based on site-specific StreamCat estimates. <a href="https://www.epa.gov/national-aquatic-resource-surveys/streamcat-dataset">(StreamCat)</a>. Note, there are approximately 50 COMIDs in WY with some missing StreamCat data. Missing adjustment factor data will cause IBI scores to be incorrectly calculated. So, we recommend inputing an estimate from a nearby, similarly sized COMID. See Table 2 for additional information on the StreamCat variables. See Table 3 for necessary input fields. For more information on the derivation of these metric adjustment factors, please read the <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Reports">WDEQ Diatom IBI report</a>. Note, only COMIDs from the state of Wyoming can be used. If the user would like COMIDs from other, nearby states, please contact Ben Block (<a href="mailto:Ben.Block@tetratech.com" class="email">Ben.Block@tetratech.com</a>) and he can update the available list.</p>
<div id="table-2.-background-information-on-streamcat-variables" class="section level4">
<h4>Table 2. Background information on StreamCat variables</h4>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;">
Variable Name
</th>
<th style="text-align:left;">
Variable Abbreviation
</th>
<th style="text-align:left;">
Variable Description
</th>
<th style="text-align:left;">
Data Source
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Elevation
</td>
<td style="text-align:left;">
Elevation
</td>
<td style="text-align:left;">
Position above sea level in feet
</td>
<td style="text-align:left;">
WY DEQ
</td>
</tr>
<tr>
<td style="text-align:left;">
Rock depth
</td>
<td style="text-align:left;">
RckDepWs
</td>
<td style="text-align:left;">
Mean depth (cm) to bedrock of soils (STATSGO) within watershed
</td>
<td style="text-align:left;">
StreamCat: STATSGO_Set2_WY.csv
</td>
</tr>
<tr>
<td style="text-align:left;">
Base Flow Index
</td>
<td style="text-align:left;">
BFIWs
</td>
<td style="text-align:left;">
Baseflow Index (BFI) is the ratio of baseflow to total flow, expressed as a percentage, within watershed.
</td>
<td style="text-align:left;">
StreamCat: BFI_WY.csv
</td>
</tr>
<tr>
<td style="text-align:left;">
Kf factor
</td>
<td style="text-align:left;">
KffactWs
</td>
<td style="text-align:left;">
Mean soil erodibility (Kf) factor (unitless) of soils within watershed. The Kf factor is used in the Universal Soil Loss Equation (USLE) and represents a relative index of susceptibility of bare, cultivated soil to particle detachment and transport by rainfall.
</td>
<td style="text-align:left;">
StreamCat: Kffact_WY.csv
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean precipitation
</td>
<td style="text-align:left;">
PrecipWs
</td>
<td style="text-align:left;">
PRISM climate data - 30-year normal mean precipitation (mm): Annual period: 1981-2010 within the watershed
</td>
<td style="text-align:left;">
StreamCat: PRISM_1981_2010_WY.csv
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean temperature
</td>
<td style="text-align:left;">
TmeanWs
</td>
<td style="text-align:left;">
PRISM climate data - 30-year normal mean temperature (°C): Annual period: 1981-2010 within the watershed
</td>
<td style="text-align:left;">
StreamCat: PRISM_1981_2010_WY.csv
</td>
</tr>
<tr>
<td style="text-align:left;">
Maximum temperature
</td>
<td style="text-align:left;">
TmaxWs
</td>
<td style="text-align:left;">
PRISM climate data - 30-year normal maximum temperature (°C): Annual period: 1981-2010 within the watershed
</td>
<td style="text-align:left;">
StreamCat: PRISM_1981_2010_WY.csv
</td>
</tr>
<tr>
<td style="text-align:left;">
Lithological sulfur
</td>
<td style="text-align:left;">
SWs
</td>
<td style="text-align:left;">
Mean % of lithological sulfur (S) content in surface or near surface geology within watershed
</td>
<td style="text-align:left;">
StreamCat: GeoChemPhys1_WY.csv
</td>
</tr>
</tbody>
</table>
</div>
<div id="table-3.-list-of-required-fields.-column-names-must-be-capitalized-and-match-the-spelling-and-symbology-exactly-as-shown." class="section level4">
<h4>Table 3. List of required fields. Column names must be capitalized and match the spelling and symbology exactly as shown.</h4>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;">
Column Name
</th>
<th style="text-align:left;">
Data Type
</th>
<th style="text-align:left;">
Null Allowed
</th>
<th style="text-align:left;">
Comment
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
STATIONID
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Any alphanumeric stationID name - should be unique.
</td>
</tr>
<tr>
<td style="text-align:left;">
COMID
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
A single COMID per stationID. To obtain COMIDs, use GIS tools to associate stationID with <a href="https://nhdplus.com/NHDPlus/">NHDPlus v2 flowline layers</a>. Contact Ben Block (<a href="mailto:Ben.Block@tetratech.com" class="email">Ben.Block@tetratech.com</a>) for help on how to properly associate sites with flowlines.
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="metric-adjustment-factors-instructions-1" class="section level3">
<h3>Metric Adjustment Factors Instructions</h3>
<p>Once opened, the user will see the metric adjustment factors interface. The user should follow the onscreen instructions as follows:</p>
<ol style="list-style-type: decimal">
<li>Load file
<ul>
<li><strong>Default settings work well</strong>. If the user is unsure of how to format the data, simply store as a .csv and use the default load settings.</li>
<li>An example input file can be downloaded from Github <a href="https://github.com/Blocktt/ShinyAppDocuments/tree/main/WDEQtools/Example_Files">EXAMPLE LINK</a></li>
<li>Choose Separator. The separator indicates how the data is stored. Comma indicates the input file is a comma-separated file (.csv). Tab indicates the input file is a tab-separated file (.txt or .tsv). Finally, Semicolon indicates the input file is a semicolon-separated file which is uncommon in the United States but common in Western-European countries. Be certain that the designated separator is not used in any of the text fields.</li>
<li>Choose Quote. The quote indicates how the data is stored. Double quote is the most common.</li>
<li>Choose file to upload. Hit the browse button and search for the input file.</li>
<li>Once uploaded, make sure data is correct in the viewer. If the incorrect Separator or Quote is chosen, the user may receive an error or the data may look incorrect in the viewer.</li>
</ul></li>
<li>Obtain factors
<ul>
<li>Hit ‘Obtain factors’ button.</li>
<li>A progress bar will appear in the bottom, right corner of the screen. Results cannot be downloaded (step 3) until the progress bar is completed and disappears.</li>
</ul></li>
<li>Download results
<ul>
<li>Select the button to download a zip file with inputs and results.</li>
<li>Check ‘results_log_maf.txt’ for any warnings or messages. Note, some warnings are automatically generated by R. Feel free to reach out to Ben Block (<a href="mailto:Ben.Block@tetratech.com" class="email">Ben.Block@tetratech.com</a>) for any questions related to warnings.</li>
</ul></li>
</ol>
</div>
</div>
